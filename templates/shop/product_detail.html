{% extends 'base.html' %}
{% load static %}

{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<script src="https://cdn.tailwindcss.com"></script>

<div class="bg-gray-100 py-10 min-h-screen">

    <div class="max-w-6xl mx-auto bg-white rounded-3xl shadow p-10">

        <!-- Breadcrumb -->
        <nav class="text-sm text-gray-500 mb-6">
            <a href="/" class="hover:text-purple-600">Home</a> /
            <a href="{% url 'product_list' %}" class="hover:text-purple-600">Products</a> /
            <span class="font-semibold text-gray-700">{{ product.name }}</span>
        </nav>

        <!-- GRID -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">

            <!-- LEFT SIDE: MAIN IMAGE + GALLERY -->
            <div>

                <!-- MAIN IMAGE -->
                <div id="mainImageContainer"
                     class="rounded-3xl shadow-lg bg-white border border-gray-200 p-4 flex items-center justify-center hover:shadow-2xl transition">
                    {% if product.image %}
                        <img id="mainImage"
                             src="{{ product.image.url }}"
                             class="w-full h-[350px] object-contain drop-shadow-xl transition-all duration-300 rounded-xl">
                    {% else %}
                        <img id="mainImage"
                             src="https://images.unsplash.com/photo-1526170375885-4d8ecf77b99f"
                             class="w-full h-[350px] object-contain drop-shadow-xl transition-all duration-300 rounded-xl">
                    {% endif %}
                </div>

                <!-- GALLERY -->
                <div class="flex gap-2 mt-4 overflow-x-auto">
                    {% for img in gallery %}
                        <img src="{{ img.image.url }}"
                             onclick="changeImage(this.src)"
                             class="thumbnail w-20 h-20 object-cover rounded-lg border border-gray-300 
                                    shadow-sm cursor-pointer bg-white p-1
                                    hover:scale-105 hover:shadow-md transition-all duration-200">
                    {% endfor %}
                </div>
            </div>

            <!-- RIGHT SIDE: PRODUCT INFO -->
            <div class="flex flex-col justify-between">

                <div>
                    <h1 class="text-3xl font-bold text-gray-900">{{ product.name }}</h1>

                    <div class="flex items-center gap-2 mt-3">
                        <span class="text-yellow-400 text-lg">★★★★★</span>
                        <span class="text-gray-500 text-sm">({{ product.rating|default:"5.0" }})</span>
                    </div>

                    <p class="mt-4 text-gray-600 leading-relaxed">
                        {{ product.description|default:"No description available." }}
                    </p>

                    <div class="mt-6">
                        <span class="text-3xl font-extrabold text-blue-600">${{ product.price }}</span>
                    </div>

                    <div class="mt-4 text-sm">
                        <p><strong class="text-gray-700">Free Delivery:</strong> Friday, March 04</p>
                        <p><strong class="text-gray-700">Fastest Delivery:</strong> Today</p>
                    </div>
                </div>

                <!-- ACTION BUTTONS -->
                <div class="mt-6">

                    <!-- QUANTITY -->
                    <div class="flex items-center gap-3 mb-4">
                        <button class="px-3 py-1 border rounded hover:bg-gray-100 transition">-</button>
                        <span class="px-4 py-1 border rounded bg-gray-50">1</span>
                        <button class="px-3 py-1 border rounded hover:bg-gray-100 transition">+</button>
                    </div>

                    <div class="flex gap-4">
                        <a href="{% url 'add_to_cart' product.id %}"
                           class="flex-1 bg-blue-600 text-white py-3 rounded-xl text-center text-lg
                                  hover:bg-blue-700 transition shadow">
                            Add to cart
                        </a>

                        <a href="{% url 'checkout' %}"
                           class="flex-1 bg-orange-500 text-white py-3 rounded-xl text-center text-lg
                                  hover:bg-orange-600 transition shadow">
                            Buy Now
                        </a>
                    </div>

                </div>

            </div>

        </div>
    </div>
</div>

<!-- JS: CHANGE MAIN IMAGE -->
<script>
function changeImage(src) {
    const mainImg = document.getElementById('mainImage');
    mainImg.style.opacity = 0;

    setTimeout(() => {
        mainImg.src = src;
        mainImg.style.opacity = 1;
    }, 200);
}
</script>

{% endblock %}
