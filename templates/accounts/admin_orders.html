{% extends "base.html" %}
{% block content %}

<div class="flex flex-col md:flex-row max-w-7xl mx-auto mt-10 px-6 gap-6">

    <!-- ================================ -->
    <!-- SIDEBAR ACTIONS -->
    <!-- ================================ -->
    <aside class="w-full md:w-64 bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-md border border-gray-200 dark:border-gray-700">
        <h2 class="text-gray-500 text-xs font-bold tracking-widest mb-3">
            ACTIONS
        </h2>

        <ul class="space-y-1">
            <!-- Ajouter produit -->
            <li>
                <a href="{% url 'admin_add_product' %}"
                   class="flex items-center gap-3 py-2 px-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-700 dark:text-gray-200">
                    <div class="w-9 h-9 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">
                        ‚ûï
                    </div>
                    <span class="text-sm font-medium">Ajouter produit</span>
                </a>
            </li>

            <!-- Back Dashboard -->
            <li>
                <a href="{% url 'admin_dashboard' %}"
                   class="flex items-center gap-3 py-2 px-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-700 dark:text-gray-200">
                    <div class="w-9 h-9 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">
                        üè†
                    </div>
                    <span class="text-sm font-medium">Back Dashboard</span>
                </a>
            </li>

            <!-- Produits -->
            <li>
                <a href="{% url 'admin_products' %}"
                   class="flex items-center gap-3 py-2 px-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-700 dark:text-gray-200">
                    <div class="w-9 h-9 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">
                        üõçÔ∏è
                    </div>
                    <span class="text-sm font-medium">Produits</span>
                </a>
            </li>

            <!-- Utilisateurs -->
            <li>
                <a href="{% url 'admin_manage_users' %}"
                   class="flex items-center gap-3 py-2 px-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-700 dark:text-gray-200">
                    <div class="w-9 h-9 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">
                        üë•
                    </div>
                    <span class="text-sm font-medium">Utilisateurs</span>
                </a>
            </li>

            <!-- Commandes -->
            <li>
                <a href="{% url 'admin_orders' %}"
                   class="flex items-center gap-3 py-2 px-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-700 dark:text-gray-200">
                    <div class="w-9 h-9 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">
                        üì¶
                    </div>
                    <span class="text-sm font-medium">Commandes</span>
                </a>
            </li>

            <!-- Profil -->
            <li>
                <a href="{% url 'edit_profile' %}"
                   class="flex items-center gap-3 py-2 px-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-700 dark:text-gray-200">
                    <div class="w-9 h-9 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">
                        üë§
                    </div>
                    <span class="text-sm font-medium">Profil</span>
                </a>
            </li>
        </ul>
    </aside>

    <!-- ================================ -->
    <!-- LISTING COMMANDES -->
    <!-- ================================ -->
    <div class="flex-1">

        <h2 class="text-3xl font-bold mb-6 text-gray-800">üì¶ Gestion des commandes (ADMIN)</h2>

        {% if orders %}
        <div class="overflow-x-auto rounded-xl shadow-lg border border-gray-200">

            <table class="min-w-full bg-white">
                <thead class="bg-gray-100 border-b">
                    <tr>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Commande</th>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Client</th>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Total</th>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Paiement</th>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Statut</th>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Date</th>
                        <th class="px-6 py-4 text-left font-semibold text-gray-700">Actions</th>
                    </tr>
                </thead>

                <tbody class="divide-y divide-gray-200">
                    {% for order in orders %}
                    <tr class="hover:bg-gray-50 transition">

                        <td class="px-6 py-4 font-semibold text-gray-900">#{{ order.id }}</td>
                        <td class="px-6 py-4 text-gray-800">{{ order.user.username }}</td>
                        <td class="px-6 py-4 font-bold text-gray-900">{{ order.total_price }} ‚Ç¨</td>
                        <td class="px-6 py-4">{{ order.payment_method }}</td>

                        <td class="px-6 py-4">
                            <span class="
                                px-3 py-1 rounded-full text-sm font-medium
                                {% if order.status == 'Pending' or order.status == 'en_attente' %}
                                    bg-yellow-100 text-yellow-700
                                {% elif order.status == 'Accepted' %}
                                    bg-green-100 text-green-700
                                {% elif order.status == 'Rejected' %}
                                    bg-red-100 text-red-700
                                {% endif %}
                            ">
                                ‚óè {{ order.status }}
                            </span>
                        </td>

                        <td class="px-6 py-4 text-gray-600">
                            {{ order.created_at|date:"d/m/Y H:i" }}
                        </td>

                        <!-- ACTIONS -->
                        <td class="px-6 py-4 space-x-3">

                            {% if order.status == "Pending" or order.status == "en_attente" %}
                            
                            <!-- BOUTON ACCEPTER -->
                            <a href="{% url 'admin_order_accept' order.id %}"
                               class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm">
                                ‚úî Accepter
                            </a>

                            <!-- BOUTON REFUSER -->
                            <a href="{% url 'admin_order_reject' order.id %}"
                               class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm">
                                ‚úñ Refuser
                            </a>

                            {% else %}
                                <span class="text-gray-500 italic">Action termin√©e</span>
                            {% endif %}

                        </td>

                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% else %}
        <div class="p-6 bg-yellow-50 border border-yellow-200 rounded-lg">
            <p class="text-yellow-800 text-lg font-medium">
                Aucune commande n‚Äôa √©t√© trouv√©e.
            </p>
        </div>
        {% endif %}

    </div>

</div>

{% endblock %}
